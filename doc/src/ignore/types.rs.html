<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `/home/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/ignore-0.4.10/src/types.rs`."><meta name="keywords" content="rust, rustlang, rust-lang"><title>types.rs - source</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc source"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../ignore/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><span class="help-button">?</span>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><pre class="line-numbers"><span id="1">  1</span>
<span id="2">  2</span>
<span id="3">  3</span>
<span id="4">  4</span>
<span id="5">  5</span>
<span id="6">  6</span>
<span id="7">  7</span>
<span id="8">  8</span>
<span id="9">  9</span>
<span id="10"> 10</span>
<span id="11"> 11</span>
<span id="12"> 12</span>
<span id="13"> 13</span>
<span id="14"> 14</span>
<span id="15"> 15</span>
<span id="16"> 16</span>
<span id="17"> 17</span>
<span id="18"> 18</span>
<span id="19"> 19</span>
<span id="20"> 20</span>
<span id="21"> 21</span>
<span id="22"> 22</span>
<span id="23"> 23</span>
<span id="24"> 24</span>
<span id="25"> 25</span>
<span id="26"> 26</span>
<span id="27"> 27</span>
<span id="28"> 28</span>
<span id="29"> 29</span>
<span id="30"> 30</span>
<span id="31"> 31</span>
<span id="32"> 32</span>
<span id="33"> 33</span>
<span id="34"> 34</span>
<span id="35"> 35</span>
<span id="36"> 36</span>
<span id="37"> 37</span>
<span id="38"> 38</span>
<span id="39"> 39</span>
<span id="40"> 40</span>
<span id="41"> 41</span>
<span id="42"> 42</span>
<span id="43"> 43</span>
<span id="44"> 44</span>
<span id="45"> 45</span>
<span id="46"> 46</span>
<span id="47"> 47</span>
<span id="48"> 48</span>
<span id="49"> 49</span>
<span id="50"> 50</span>
<span id="51"> 51</span>
<span id="52"> 52</span>
<span id="53"> 53</span>
<span id="54"> 54</span>
<span id="55"> 55</span>
<span id="56"> 56</span>
<span id="57"> 57</span>
<span id="58"> 58</span>
<span id="59"> 59</span>
<span id="60"> 60</span>
<span id="61"> 61</span>
<span id="62"> 62</span>
<span id="63"> 63</span>
<span id="64"> 64</span>
<span id="65"> 65</span>
<span id="66"> 66</span>
<span id="67"> 67</span>
<span id="68"> 68</span>
<span id="69"> 69</span>
<span id="70"> 70</span>
<span id="71"> 71</span>
<span id="72"> 72</span>
<span id="73"> 73</span>
<span id="74"> 74</span>
<span id="75"> 75</span>
<span id="76"> 76</span>
<span id="77"> 77</span>
<span id="78"> 78</span>
<span id="79"> 79</span>
<span id="80"> 80</span>
<span id="81"> 81</span>
<span id="82"> 82</span>
<span id="83"> 83</span>
<span id="84"> 84</span>
<span id="85"> 85</span>
<span id="86"> 86</span>
<span id="87"> 87</span>
<span id="88"> 88</span>
<span id="89"> 89</span>
<span id="90"> 90</span>
<span id="91"> 91</span>
<span id="92"> 92</span>
<span id="93"> 93</span>
<span id="94"> 94</span>
<span id="95"> 95</span>
<span id="96"> 96</span>
<span id="97"> 97</span>
<span id="98"> 98</span>
<span id="99"> 99</span>
<span id="100">100</span>
<span id="101">101</span>
<span id="102">102</span>
<span id="103">103</span>
<span id="104">104</span>
<span id="105">105</span>
<span id="106">106</span>
<span id="107">107</span>
<span id="108">108</span>
<span id="109">109</span>
<span id="110">110</span>
<span id="111">111</span>
<span id="112">112</span>
<span id="113">113</span>
<span id="114">114</span>
<span id="115">115</span>
<span id="116">116</span>
<span id="117">117</span>
<span id="118">118</span>
<span id="119">119</span>
<span id="120">120</span>
<span id="121">121</span>
<span id="122">122</span>
<span id="123">123</span>
<span id="124">124</span>
<span id="125">125</span>
<span id="126">126</span>
<span id="127">127</span>
<span id="128">128</span>
<span id="129">129</span>
<span id="130">130</span>
<span id="131">131</span>
<span id="132">132</span>
<span id="133">133</span>
<span id="134">134</span>
<span id="135">135</span>
<span id="136">136</span>
<span id="137">137</span>
<span id="138">138</span>
<span id="139">139</span>
<span id="140">140</span>
<span id="141">141</span>
<span id="142">142</span>
<span id="143">143</span>
<span id="144">144</span>
<span id="145">145</span>
<span id="146">146</span>
<span id="147">147</span>
<span id="148">148</span>
<span id="149">149</span>
<span id="150">150</span>
<span id="151">151</span>
<span id="152">152</span>
<span id="153">153</span>
<span id="154">154</span>
<span id="155">155</span>
<span id="156">156</span>
<span id="157">157</span>
<span id="158">158</span>
<span id="159">159</span>
<span id="160">160</span>
<span id="161">161</span>
<span id="162">162</span>
<span id="163">163</span>
<span id="164">164</span>
<span id="165">165</span>
<span id="166">166</span>
<span id="167">167</span>
<span id="168">168</span>
<span id="169">169</span>
<span id="170">170</span>
<span id="171">171</span>
<span id="172">172</span>
<span id="173">173</span>
<span id="174">174</span>
<span id="175">175</span>
<span id="176">176</span>
<span id="177">177</span>
<span id="178">178</span>
<span id="179">179</span>
<span id="180">180</span>
<span id="181">181</span>
<span id="182">182</span>
<span id="183">183</span>
<span id="184">184</span>
<span id="185">185</span>
<span id="186">186</span>
<span id="187">187</span>
<span id="188">188</span>
<span id="189">189</span>
<span id="190">190</span>
<span id="191">191</span>
<span id="192">192</span>
<span id="193">193</span>
<span id="194">194</span>
<span id="195">195</span>
<span id="196">196</span>
<span id="197">197</span>
<span id="198">198</span>
<span id="199">199</span>
<span id="200">200</span>
<span id="201">201</span>
<span id="202">202</span>
<span id="203">203</span>
<span id="204">204</span>
<span id="205">205</span>
<span id="206">206</span>
<span id="207">207</span>
<span id="208">208</span>
<span id="209">209</span>
<span id="210">210</span>
<span id="211">211</span>
<span id="212">212</span>
<span id="213">213</span>
<span id="214">214</span>
<span id="215">215</span>
<span id="216">216</span>
<span id="217">217</span>
<span id="218">218</span>
<span id="219">219</span>
<span id="220">220</span>
<span id="221">221</span>
<span id="222">222</span>
<span id="223">223</span>
<span id="224">224</span>
<span id="225">225</span>
<span id="226">226</span>
<span id="227">227</span>
<span id="228">228</span>
<span id="229">229</span>
<span id="230">230</span>
<span id="231">231</span>
<span id="232">232</span>
<span id="233">233</span>
<span id="234">234</span>
<span id="235">235</span>
<span id="236">236</span>
<span id="237">237</span>
<span id="238">238</span>
<span id="239">239</span>
<span id="240">240</span>
<span id="241">241</span>
<span id="242">242</span>
<span id="243">243</span>
<span id="244">244</span>
<span id="245">245</span>
<span id="246">246</span>
<span id="247">247</span>
<span id="248">248</span>
<span id="249">249</span>
<span id="250">250</span>
<span id="251">251</span>
<span id="252">252</span>
<span id="253">253</span>
<span id="254">254</span>
<span id="255">255</span>
<span id="256">256</span>
<span id="257">257</span>
<span id="258">258</span>
<span id="259">259</span>
<span id="260">260</span>
<span id="261">261</span>
<span id="262">262</span>
<span id="263">263</span>
<span id="264">264</span>
<span id="265">265</span>
<span id="266">266</span>
<span id="267">267</span>
<span id="268">268</span>
<span id="269">269</span>
<span id="270">270</span>
<span id="271">271</span>
<span id="272">272</span>
<span id="273">273</span>
<span id="274">274</span>
<span id="275">275</span>
<span id="276">276</span>
<span id="277">277</span>
<span id="278">278</span>
<span id="279">279</span>
<span id="280">280</span>
<span id="281">281</span>
<span id="282">282</span>
<span id="283">283</span>
<span id="284">284</span>
<span id="285">285</span>
<span id="286">286</span>
<span id="287">287</span>
<span id="288">288</span>
<span id="289">289</span>
<span id="290">290</span>
<span id="291">291</span>
<span id="292">292</span>
<span id="293">293</span>
<span id="294">294</span>
<span id="295">295</span>
<span id="296">296</span>
<span id="297">297</span>
<span id="298">298</span>
<span id="299">299</span>
<span id="300">300</span>
<span id="301">301</span>
<span id="302">302</span>
<span id="303">303</span>
<span id="304">304</span>
<span id="305">305</span>
<span id="306">306</span>
<span id="307">307</span>
<span id="308">308</span>
<span id="309">309</span>
<span id="310">310</span>
<span id="311">311</span>
<span id="312">312</span>
<span id="313">313</span>
<span id="314">314</span>
<span id="315">315</span>
<span id="316">316</span>
<span id="317">317</span>
<span id="318">318</span>
<span id="319">319</span>
<span id="320">320</span>
<span id="321">321</span>
<span id="322">322</span>
<span id="323">323</span>
<span id="324">324</span>
<span id="325">325</span>
<span id="326">326</span>
<span id="327">327</span>
<span id="328">328</span>
<span id="329">329</span>
<span id="330">330</span>
<span id="331">331</span>
<span id="332">332</span>
<span id="333">333</span>
<span id="334">334</span>
<span id="335">335</span>
<span id="336">336</span>
<span id="337">337</span>
<span id="338">338</span>
<span id="339">339</span>
<span id="340">340</span>
<span id="341">341</span>
<span id="342">342</span>
<span id="343">343</span>
<span id="344">344</span>
<span id="345">345</span>
<span id="346">346</span>
<span id="347">347</span>
<span id="348">348</span>
<span id="349">349</span>
<span id="350">350</span>
<span id="351">351</span>
<span id="352">352</span>
<span id="353">353</span>
<span id="354">354</span>
<span id="355">355</span>
<span id="356">356</span>
<span id="357">357</span>
<span id="358">358</span>
<span id="359">359</span>
<span id="360">360</span>
<span id="361">361</span>
<span id="362">362</span>
<span id="363">363</span>
<span id="364">364</span>
<span id="365">365</span>
<span id="366">366</span>
<span id="367">367</span>
<span id="368">368</span>
<span id="369">369</span>
<span id="370">370</span>
<span id="371">371</span>
<span id="372">372</span>
<span id="373">373</span>
<span id="374">374</span>
<span id="375">375</span>
<span id="376">376</span>
<span id="377">377</span>
<span id="378">378</span>
<span id="379">379</span>
<span id="380">380</span>
<span id="381">381</span>
<span id="382">382</span>
<span id="383">383</span>
<span id="384">384</span>
<span id="385">385</span>
<span id="386">386</span>
<span id="387">387</span>
<span id="388">388</span>
<span id="389">389</span>
<span id="390">390</span>
<span id="391">391</span>
<span id="392">392</span>
<span id="393">393</span>
<span id="394">394</span>
<span id="395">395</span>
<span id="396">396</span>
<span id="397">397</span>
<span id="398">398</span>
<span id="399">399</span>
<span id="400">400</span>
<span id="401">401</span>
<span id="402">402</span>
<span id="403">403</span>
<span id="404">404</span>
<span id="405">405</span>
<span id="406">406</span>
<span id="407">407</span>
<span id="408">408</span>
<span id="409">409</span>
<span id="410">410</span>
<span id="411">411</span>
<span id="412">412</span>
<span id="413">413</span>
<span id="414">414</span>
<span id="415">415</span>
<span id="416">416</span>
<span id="417">417</span>
<span id="418">418</span>
<span id="419">419</span>
<span id="420">420</span>
<span id="421">421</span>
<span id="422">422</span>
<span id="423">423</span>
<span id="424">424</span>
<span id="425">425</span>
<span id="426">426</span>
<span id="427">427</span>
<span id="428">428</span>
<span id="429">429</span>
<span id="430">430</span>
<span id="431">431</span>
<span id="432">432</span>
<span id="433">433</span>
<span id="434">434</span>
<span id="435">435</span>
<span id="436">436</span>
<span id="437">437</span>
<span id="438">438</span>
<span id="439">439</span>
<span id="440">440</span>
<span id="441">441</span>
<span id="442">442</span>
<span id="443">443</span>
<span id="444">444</span>
<span id="445">445</span>
<span id="446">446</span>
<span id="447">447</span>
<span id="448">448</span>
<span id="449">449</span>
<span id="450">450</span>
<span id="451">451</span>
<span id="452">452</span>
<span id="453">453</span>
<span id="454">454</span>
<span id="455">455</span>
<span id="456">456</span>
<span id="457">457</span>
<span id="458">458</span>
<span id="459">459</span>
<span id="460">460</span>
<span id="461">461</span>
<span id="462">462</span>
<span id="463">463</span>
<span id="464">464</span>
<span id="465">465</span>
<span id="466">466</span>
<span id="467">467</span>
<span id="468">468</span>
<span id="469">469</span>
<span id="470">470</span>
<span id="471">471</span>
<span id="472">472</span>
<span id="473">473</span>
<span id="474">474</span>
<span id="475">475</span>
<span id="476">476</span>
<span id="477">477</span>
<span id="478">478</span>
<span id="479">479</span>
<span id="480">480</span>
<span id="481">481</span>
<span id="482">482</span>
<span id="483">483</span>
<span id="484">484</span>
<span id="485">485</span>
<span id="486">486</span>
<span id="487">487</span>
<span id="488">488</span>
<span id="489">489</span>
<span id="490">490</span>
<span id="491">491</span>
<span id="492">492</span>
<span id="493">493</span>
<span id="494">494</span>
<span id="495">495</span>
<span id="496">496</span>
<span id="497">497</span>
<span id="498">498</span>
<span id="499">499</span>
<span id="500">500</span>
<span id="501">501</span>
<span id="502">502</span>
<span id="503">503</span>
<span id="504">504</span>
<span id="505">505</span>
<span id="506">506</span>
<span id="507">507</span>
<span id="508">508</span>
<span id="509">509</span>
<span id="510">510</span>
<span id="511">511</span>
<span id="512">512</span>
<span id="513">513</span>
<span id="514">514</span>
<span id="515">515</span>
<span id="516">516</span>
<span id="517">517</span>
<span id="518">518</span>
<span id="519">519</span>
<span id="520">520</span>
<span id="521">521</span>
<span id="522">522</span>
<span id="523">523</span>
<span id="524">524</span>
<span id="525">525</span>
<span id="526">526</span>
<span id="527">527</span>
<span id="528">528</span>
<span id="529">529</span>
<span id="530">530</span>
<span id="531">531</span>
<span id="532">532</span>
<span id="533">533</span>
<span id="534">534</span>
<span id="535">535</span>
<span id="536">536</span>
<span id="537">537</span>
<span id="538">538</span>
<span id="539">539</span>
<span id="540">540</span>
<span id="541">541</span>
<span id="542">542</span>
<span id="543">543</span>
<span id="544">544</span>
<span id="545">545</span>
<span id="546">546</span>
<span id="547">547</span>
<span id="548">548</span>
<span id="549">549</span>
<span id="550">550</span>
<span id="551">551</span>
<span id="552">552</span>
<span id="553">553</span>
<span id="554">554</span>
<span id="555">555</span>
<span id="556">556</span>
<span id="557">557</span>
<span id="558">558</span>
<span id="559">559</span>
<span id="560">560</span>
<span id="561">561</span>
<span id="562">562</span>
<span id="563">563</span>
<span id="564">564</span>
<span id="565">565</span>
<span id="566">566</span>
<span id="567">567</span>
<span id="568">568</span>
<span id="569">569</span>
<span id="570">570</span>
<span id="571">571</span>
<span id="572">572</span>
<span id="573">573</span>
<span id="574">574</span>
<span id="575">575</span>
<span id="576">576</span>
<span id="577">577</span>
<span id="578">578</span>
<span id="579">579</span>
<span id="580">580</span>
<span id="581">581</span>
<span id="582">582</span>
<span id="583">583</span>
<span id="584">584</span>
<span id="585">585</span>
<span id="586">586</span>
<span id="587">587</span>
<span id="588">588</span>
<span id="589">589</span>
<span id="590">590</span>
<span id="591">591</span>
<span id="592">592</span>
<span id="593">593</span>
<span id="594">594</span>
<span id="595">595</span>
<span id="596">596</span>
<span id="597">597</span>
<span id="598">598</span>
<span id="599">599</span>
<span id="600">600</span>
<span id="601">601</span>
<span id="602">602</span>
<span id="603">603</span>
<span id="604">604</span>
<span id="605">605</span>
<span id="606">606</span>
<span id="607">607</span>
<span id="608">608</span>
<span id="609">609</span>
<span id="610">610</span>
<span id="611">611</span>
<span id="612">612</span>
<span id="613">613</span>
<span id="614">614</span>
<span id="615">615</span>
<span id="616">616</span>
<span id="617">617</span>
<span id="618">618</span>
<span id="619">619</span>
<span id="620">620</span>
<span id="621">621</span>
<span id="622">622</span>
<span id="623">623</span>
<span id="624">624</span>
<span id="625">625</span>
<span id="626">626</span>
<span id="627">627</span>
<span id="628">628</span>
<span id="629">629</span>
<span id="630">630</span>
<span id="631">631</span>
<span id="632">632</span>
<span id="633">633</span>
<span id="634">634</span>
<span id="635">635</span>
<span id="636">636</span>
<span id="637">637</span>
<span id="638">638</span>
<span id="639">639</span>
<span id="640">640</span>
<span id="641">641</span>
<span id="642">642</span>
<span id="643">643</span>
<span id="644">644</span>
<span id="645">645</span>
<span id="646">646</span>
<span id="647">647</span>
<span id="648">648</span>
<span id="649">649</span>
<span id="650">650</span>
<span id="651">651</span>
<span id="652">652</span>
<span id="653">653</span>
<span id="654">654</span>
<span id="655">655</span>
<span id="656">656</span>
<span id="657">657</span>
<span id="658">658</span>
<span id="659">659</span>
<span id="660">660</span>
<span id="661">661</span>
<span id="662">662</span>
<span id="663">663</span>
<span id="664">664</span>
<span id="665">665</span>
<span id="666">666</span>
<span id="667">667</span>
<span id="668">668</span>
<span id="669">669</span>
<span id="670">670</span>
<span id="671">671</span>
<span id="672">672</span>
<span id="673">673</span>
<span id="674">674</span>
<span id="675">675</span>
<span id="676">676</span>
<span id="677">677</span>
<span id="678">678</span>
<span id="679">679</span>
<span id="680">680</span>
<span id="681">681</span>
<span id="682">682</span>
<span id="683">683</span>
<span id="684">684</span>
<span id="685">685</span>
<span id="686">686</span>
<span id="687">687</span>
<span id="688">688</span>
<span id="689">689</span>
<span id="690">690</span>
<span id="691">691</span>
<span id="692">692</span>
<span id="693">693</span>
<span id="694">694</span>
<span id="695">695</span>
<span id="696">696</span>
<span id="697">697</span>
<span id="698">698</span>
<span id="699">699</span>
<span id="700">700</span>
<span id="701">701</span>
<span id="702">702</span>
<span id="703">703</span>
<span id="704">704</span>
<span id="705">705</span>
<span id="706">706</span>
<span id="707">707</span>
<span id="708">708</span>
<span id="709">709</span>
<span id="710">710</span>
<span id="711">711</span>
<span id="712">712</span>
<span id="713">713</span>
<span id="714">714</span>
<span id="715">715</span>
<span id="716">716</span>
<span id="717">717</span>
<span id="718">718</span>
<span id="719">719</span>
<span id="720">720</span>
<span id="721">721</span>
<span id="722">722</span>
<span id="723">723</span>
<span id="724">724</span>
<span id="725">725</span>
<span id="726">726</span>
<span id="727">727</span>
<span id="728">728</span>
<span id="729">729</span>
<span id="730">730</span>
<span id="731">731</span>
<span id="732">732</span>
<span id="733">733</span>
<span id="734">734</span>
<span id="735">735</span>
<span id="736">736</span>
<span id="737">737</span>
<span id="738">738</span>
<span id="739">739</span>
<span id="740">740</span>
<span id="741">741</span>
<span id="742">742</span>
<span id="743">743</span>
<span id="744">744</span>
<span id="745">745</span>
<span id="746">746</span>
<span id="747">747</span>
<span id="748">748</span>
<span id="749">749</span>
<span id="750">750</span>
<span id="751">751</span>
<span id="752">752</span>
<span id="753">753</span>
<span id="754">754</span>
<span id="755">755</span>
<span id="756">756</span>
<span id="757">757</span>
<span id="758">758</span>
<span id="759">759</span>
<span id="760">760</span>
<span id="761">761</span>
<span id="762">762</span>
<span id="763">763</span>
<span id="764">764</span>
<span id="765">765</span>
<span id="766">766</span>
<span id="767">767</span>
<span id="768">768</span>
<span id="769">769</span>
<span id="770">770</span>
<span id="771">771</span>
<span id="772">772</span>
<span id="773">773</span>
<span id="774">774</span>
<span id="775">775</span>
<span id="776">776</span>
<span id="777">777</span>
<span id="778">778</span>
<span id="779">779</span>
<span id="780">780</span>
<span id="781">781</span>
<span id="782">782</span>
<span id="783">783</span>
<span id="784">784</span>
<span id="785">785</span>
<span id="786">786</span>
<span id="787">787</span>
<span id="788">788</span>
<span id="789">789</span>
<span id="790">790</span>
<span id="791">791</span>
<span id="792">792</span>
<span id="793">793</span>
<span id="794">794</span>
<span id="795">795</span>
<span id="796">796</span>
<span id="797">797</span>
<span id="798">798</span>
<span id="799">799</span>
<span id="800">800</span>
<span id="801">801</span>
<span id="802">802</span>
<span id="803">803</span>
<span id="804">804</span>
<span id="805">805</span>
<span id="806">806</span>
<span id="807">807</span>
<span id="808">808</span>
<span id="809">809</span>
<span id="810">810</span>
<span id="811">811</span>
<span id="812">812</span>
<span id="813">813</span>
<span id="814">814</span>
</pre><div class="example-wrap"><pre class="rust ">
<span class="doccomment">/*!
The types module provides a way of associating globs on file names to file
types.

This can be used to match specific types of files. For example, among
the default file types provided, the Rust file type is defined to be `*.rs`
with name `rust`. Similarly, the C file type is defined to be `*.{c,h}` with
name `c`.

Note that the set of default types may change over time.

# Example

This shows how to create and use a simple file type matcher using the default
file types defined in this crate.

```
use ignore::types::TypesBuilder;

let mut builder = TypesBuilder::new();
builder.add_defaults();
builder.select(&quot;rust&quot;);
let matcher = builder.build().unwrap();

assert!(matcher.matched(&quot;foo.rs&quot;, false).is_whitelist());
assert!(matcher.matched(&quot;foo.c&quot;, false).is_ignore());
```

# Example: negation

This is like the previous example, but shows how negating a file type works.
That is, this will let us match file paths that *don&#39;t* correspond to a
particular file type.

```
use ignore::types::TypesBuilder;

let mut builder = TypesBuilder::new();
builder.add_defaults();
builder.negate(&quot;c&quot;);
let matcher = builder.build().unwrap();

assert!(matcher.matched(&quot;foo.rs&quot;, false).is_none());
assert!(matcher.matched(&quot;foo.c&quot;, false).is_ignore());
```

# Example: custom file type definitions

This shows how to extend this library default file type definitions with
your own.

```
use ignore::types::TypesBuilder;

let mut builder = TypesBuilder::new();
builder.add_defaults();
builder.add(&quot;foo&quot;, &quot;*.foo&quot;);
// Another way of adding a file type definition.
// This is useful when accepting input from an end user.
builder.add_def(&quot;bar:*.bar&quot;);
// Note: we only select `foo`, not `bar`.
builder.select(&quot;foo&quot;);
let matcher = builder.build().unwrap();

assert!(matcher.matched(&quot;x.foo&quot;, false).is_whitelist());
// This is ignored because we only selected the `foo` file type.
assert!(matcher.matched(&quot;x.bar&quot;, false).is_ignore());
```

We can also add file type definitions based on other definitions.

```
use ignore::types::TypesBuilder;

let mut builder = TypesBuilder::new();
builder.add_defaults();
builder.add(&quot;foo&quot;, &quot;*.foo&quot;);
builder.add_def(&quot;bar:include:foo,cpp&quot;);
builder.select(&quot;bar&quot;);
let matcher = builder.build().unwrap();

assert!(matcher.matched(&quot;x.foo&quot;, false).is_whitelist());
assert!(matcher.matched(&quot;y.cpp&quot;, false).is_whitelist());
```
*/</span>

<span class="kw">use</span> <span class="ident">std</span>::<span class="ident">cell</span>::<span class="ident">RefCell</span>;
<span class="kw">use</span> <span class="ident">std</span>::<span class="ident">collections</span>::<span class="ident">HashMap</span>;
<span class="kw">use</span> <span class="ident">std</span>::<span class="ident">path</span>::<span class="ident">Path</span>;
<span class="kw">use</span> <span class="ident">std</span>::<span class="ident">sync</span>::<span class="ident">Arc</span>;

<span class="kw">use</span> <span class="ident">globset</span>::{<span class="ident">GlobBuilder</span>, <span class="ident">GlobSet</span>, <span class="ident">GlobSetBuilder</span>};
<span class="kw">use</span> <span class="ident">regex</span>::<span class="ident">Regex</span>;
<span class="kw">use</span> <span class="ident">thread_local</span>::<span class="ident">ThreadLocal</span>;

<span class="kw">use</span> <span class="ident">pathutil</span>::<span class="ident">file_name</span>;
<span class="kw">use</span> {<span class="ident">Error</span>, <span class="ident">Match</span>};

<span class="kw">const</span> <span class="ident">DEFAULT_TYPES</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> [(<span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span>, <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> [<span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span>])] <span class="op">=</span> <span class="kw-2">&amp;</span>[
    (<span class="string">&quot;agda&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.agda&quot;</span>, <span class="string">&quot;*.lagda&quot;</span>]),
    (<span class="string">&quot;ats&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ats&quot;</span>, <span class="string">&quot;*.dats&quot;</span>, <span class="string">&quot;*.sats&quot;</span>, <span class="string">&quot;*.hats&quot;</span>]),
    (<span class="string">&quot;aidl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.aidl&quot;</span>]),
    (<span class="string">&quot;amake&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.mk&quot;</span>, <span class="string">&quot;*.bp&quot;</span>]),
    (<span class="string">&quot;asciidoc&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.adoc&quot;</span>, <span class="string">&quot;*.asc&quot;</span>, <span class="string">&quot;*.asciidoc&quot;</span>]),
    (<span class="string">&quot;asm&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.asm&quot;</span>, <span class="string">&quot;*.s&quot;</span>, <span class="string">&quot;*.S&quot;</span>]),
    (<span class="string">&quot;asp&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.aspx&quot;</span>, <span class="string">&quot;*.aspx.cs&quot;</span>, <span class="string">&quot;*.aspx.cs&quot;</span>, <span class="string">&quot;*.ascx&quot;</span>, <span class="string">&quot;*.ascx.cs&quot;</span>, <span class="string">&quot;*.ascx.vb&quot;</span>]),
    (<span class="string">&quot;avro&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.avdl&quot;</span>, <span class="string">&quot;*.avpr&quot;</span>, <span class="string">&quot;*.avsc&quot;</span>]),
    (<span class="string">&quot;awk&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.awk&quot;</span>]),
    (<span class="string">&quot;bazel&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.bzl&quot;</span>, <span class="string">&quot;WORKSPACE&quot;</span>, <span class="string">&quot;BUILD&quot;</span>, <span class="string">&quot;BUILD.bazel&quot;</span>]),
    (<span class="string">&quot;bitbake&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.bb&quot;</span>, <span class="string">&quot;*.bbappend&quot;</span>, <span class="string">&quot;*.bbclass&quot;</span>, <span class="string">&quot;*.conf&quot;</span>, <span class="string">&quot;*.inc&quot;</span>]),
    (<span class="string">&quot;brotli&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.br&quot;</span>]),
    (<span class="string">&quot;buildstream&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.bst&quot;</span>]),
    (<span class="string">&quot;bzip2&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.bz2&quot;</span>, <span class="string">&quot;*.tbz2&quot;</span>]),
    (<span class="string">&quot;c&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.[chH]&quot;</span>, <span class="string">&quot;*.[chH].in&quot;</span>, <span class="string">&quot;*.cats&quot;</span>]),
    (<span class="string">&quot;cabal&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cabal&quot;</span>]),
    (<span class="string">&quot;cbor&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cbor&quot;</span>]),
    (<span class="string">&quot;ceylon&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ceylon&quot;</span>]),
    (<span class="string">&quot;clojure&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.clj&quot;</span>, <span class="string">&quot;*.cljc&quot;</span>, <span class="string">&quot;*.cljs&quot;</span>, <span class="string">&quot;*.cljx&quot;</span>]),
    (<span class="string">&quot;cmake&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cmake&quot;</span>, <span class="string">&quot;CMakeLists.txt&quot;</span>]),
    (<span class="string">&quot;coffeescript&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.coffee&quot;</span>]),
    (<span class="string">&quot;creole&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.creole&quot;</span>]),
    (<span class="string">&quot;config&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cfg&quot;</span>, <span class="string">&quot;*.conf&quot;</span>, <span class="string">&quot;*.config&quot;</span>, <span class="string">&quot;*.ini&quot;</span>]),
    (<span class="string">&quot;cpp&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;*.[ChH]&quot;</span>, <span class="string">&quot;*.cc&quot;</span>, <span class="string">&quot;*.[ch]pp&quot;</span>, <span class="string">&quot;*.[ch]xx&quot;</span>, <span class="string">&quot;*.hh&quot;</span>,  <span class="string">&quot;*.inl&quot;</span>,
        <span class="string">&quot;*.[ChH].in&quot;</span>, <span class="string">&quot;*.cc.in&quot;</span>, <span class="string">&quot;*.[ch]pp.in&quot;</span>, <span class="string">&quot;*.[ch]xx.in&quot;</span>, <span class="string">&quot;*.hh.in&quot;</span>,
    ]),
    (<span class="string">&quot;crystal&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;Projectfile&quot;</span>, <span class="string">&quot;*.cr&quot;</span>]),
    (<span class="string">&quot;cs&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cs&quot;</span>]),
    (<span class="string">&quot;csharp&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cs&quot;</span>]),
    (<span class="string">&quot;cshtml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cshtml&quot;</span>]),
    (<span class="string">&quot;css&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.css&quot;</span>, <span class="string">&quot;*.scss&quot;</span>]),
    (<span class="string">&quot;csv&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.csv&quot;</span>]),
    (<span class="string">&quot;cython&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.pyx&quot;</span>, <span class="string">&quot;*.pxi&quot;</span>, <span class="string">&quot;*.pxd&quot;</span>]),
    (<span class="string">&quot;dart&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.dart&quot;</span>]),
    (<span class="string">&quot;d&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.d&quot;</span>]),
    (<span class="string">&quot;dhall&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.dhall&quot;</span>]),
    (<span class="string">&quot;docker&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*Dockerfile*&quot;</span>]),
    (<span class="string">&quot;edn&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.edn&quot;</span>]),
    (<span class="string">&quot;elisp&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.el&quot;</span>]),
    (<span class="string">&quot;elixir&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ex&quot;</span>, <span class="string">&quot;*.eex&quot;</span>, <span class="string">&quot;*.exs&quot;</span>]),
    (<span class="string">&quot;elm&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.elm&quot;</span>]),
    (<span class="string">&quot;erlang&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.erl&quot;</span>, <span class="string">&quot;*.hrl&quot;</span>]),
    (<span class="string">&quot;fidl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.fidl&quot;</span>]),
    (<span class="string">&quot;fish&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.fish&quot;</span>]),
    (<span class="string">&quot;fortran&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;*.f&quot;</span>, <span class="string">&quot;*.F&quot;</span>, <span class="string">&quot;*.f77&quot;</span>, <span class="string">&quot;*.F77&quot;</span>, <span class="string">&quot;*.pfo&quot;</span>,
        <span class="string">&quot;*.f90&quot;</span>, <span class="string">&quot;*.F90&quot;</span>, <span class="string">&quot;*.f95&quot;</span>, <span class="string">&quot;*.F95&quot;</span>,
    ]),
    (<span class="string">&quot;fsharp&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.fs&quot;</span>, <span class="string">&quot;*.fsx&quot;</span>, <span class="string">&quot;*.fsi&quot;</span>]),
    (<span class="string">&quot;gap&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.g&quot;</span>, <span class="string">&quot;*.gap&quot;</span>, <span class="string">&quot;*.gi&quot;</span>, <span class="string">&quot;*.gd&quot;</span>, <span class="string">&quot;*.tst&quot;</span>]),
    (<span class="string">&quot;gn&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.gn&quot;</span>, <span class="string">&quot;*.gni&quot;</span>]),
    (<span class="string">&quot;go&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.go&quot;</span>]),
    (<span class="string">&quot;gzip&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.gz&quot;</span>, <span class="string">&quot;*.tgz&quot;</span>]),
    (<span class="string">&quot;groovy&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.groovy&quot;</span>, <span class="string">&quot;*.gradle&quot;</span>]),
    (<span class="string">&quot;h&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.h&quot;</span>, <span class="string">&quot;*.hpp&quot;</span>]),
    (<span class="string">&quot;hbs&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.hbs&quot;</span>]),
    (<span class="string">&quot;haskell&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.hs&quot;</span>, <span class="string">&quot;*.lhs&quot;</span>, <span class="string">&quot;*.cpphs&quot;</span>, <span class="string">&quot;*.c2hs&quot;</span>, <span class="string">&quot;*.hsc&quot;</span>]),
    (<span class="string">&quot;hs&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.hs&quot;</span>, <span class="string">&quot;*.lhs&quot;</span>]),
    (<span class="string">&quot;html&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.htm&quot;</span>, <span class="string">&quot;*.html&quot;</span>, <span class="string">&quot;*.ejs&quot;</span>]),
    (<span class="string">&quot;idris&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.idr&quot;</span>, <span class="string">&quot;*.lidr&quot;</span>]),
    (<span class="string">&quot;java&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.java&quot;</span>, <span class="string">&quot;*.jsp&quot;</span>, <span class="string">&quot;*.jspx&quot;</span>, <span class="string">&quot;*.properties&quot;</span>]),
    (<span class="string">&quot;jinja&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.j2&quot;</span>, <span class="string">&quot;*.jinja&quot;</span>, <span class="string">&quot;*.jinja2&quot;</span>]),
    (<span class="string">&quot;js&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;*.js&quot;</span>, <span class="string">&quot;*.jsx&quot;</span>, <span class="string">&quot;*.vue&quot;</span>,
    ]),
    (<span class="string">&quot;json&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.json&quot;</span>, <span class="string">&quot;composer.lock&quot;</span>]),
    (<span class="string">&quot;jsonl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.jsonl&quot;</span>]),
    (<span class="string">&quot;julia&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.jl&quot;</span>]),
    (<span class="string">&quot;jupyter&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ipynb&quot;</span>, <span class="string">&quot;*.jpynb&quot;</span>]),
    (<span class="string">&quot;jl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.jl&quot;</span>]),
    (<span class="string">&quot;kotlin&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.kt&quot;</span>, <span class="string">&quot;*.kts&quot;</span>]),
    (<span class="string">&quot;less&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.less&quot;</span>]),
    (<span class="string">&quot;license&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="comment">// General</span>
        <span class="string">&quot;COPYING&quot;</span>, <span class="string">&quot;COPYING[.-]*&quot;</span>,
        <span class="string">&quot;COPYRIGHT&quot;</span>, <span class="string">&quot;COPYRIGHT[.-]*&quot;</span>,
        <span class="string">&quot;EULA&quot;</span>, <span class="string">&quot;EULA[.-]*&quot;</span>,
        <span class="string">&quot;licen[cs]e&quot;</span>, <span class="string">&quot;licen[cs]e.*&quot;</span>,
        <span class="string">&quot;LICEN[CS]E&quot;</span>, <span class="string">&quot;LICEN[CS]E[.-]*&quot;</span>, <span class="string">&quot;*[.-]LICEN[CS]E*&quot;</span>,
        <span class="string">&quot;NOTICE&quot;</span>, <span class="string">&quot;NOTICE[.-]*&quot;</span>,
        <span class="string">&quot;PATENTS&quot;</span>, <span class="string">&quot;PATENTS[.-]*&quot;</span>,
        <span class="string">&quot;UNLICEN[CS]E&quot;</span>, <span class="string">&quot;UNLICEN[CS]E[.-]*&quot;</span>,
        <span class="comment">// GPL (gpl.txt, etc.)</span>
        <span class="string">&quot;agpl[.-]*&quot;</span>,
        <span class="string">&quot;gpl[.-]*&quot;</span>,
        <span class="string">&quot;lgpl[.-]*&quot;</span>,
        <span class="comment">// Other license-specific (APACHE-2.0.txt, etc.)</span>
        <span class="string">&quot;AGPL-*[0-9]*&quot;</span>,
        <span class="string">&quot;APACHE-*[0-9]*&quot;</span>,
        <span class="string">&quot;BSD-*[0-9]*&quot;</span>,
        <span class="string">&quot;CC-BY-*&quot;</span>,
        <span class="string">&quot;GFDL-*[0-9]*&quot;</span>,
        <span class="string">&quot;GNU-*[0-9]*&quot;</span>,
        <span class="string">&quot;GPL-*[0-9]*&quot;</span>,
        <span class="string">&quot;LGPL-*[0-9]*&quot;</span>,
        <span class="string">&quot;MIT-*[0-9]*&quot;</span>,
        <span class="string">&quot;MPL-*[0-9]*&quot;</span>,
        <span class="string">&quot;OFL-*[0-9]*&quot;</span>,
    ]),
    (<span class="string">&quot;lisp&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.el&quot;</span>, <span class="string">&quot;*.jl&quot;</span>, <span class="string">&quot;*.lisp&quot;</span>, <span class="string">&quot;*.lsp&quot;</span>, <span class="string">&quot;*.sc&quot;</span>, <span class="string">&quot;*.scm&quot;</span>]),
    (<span class="string">&quot;lock&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.lock&quot;</span>, <span class="string">&quot;package-lock.json&quot;</span>]),
    (<span class="string">&quot;log&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.log&quot;</span>]),
    (<span class="string">&quot;lua&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.lua&quot;</span>]),
    (<span class="string">&quot;lzma&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.lzma&quot;</span>]),
    (<span class="string">&quot;lz4&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.lz4&quot;</span>]),
    (<span class="string">&quot;m4&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ac&quot;</span>, <span class="string">&quot;*.m4&quot;</span>]),
    (<span class="string">&quot;make&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;[Gg][Nn][Uu]makefile&quot;</span>, <span class="string">&quot;[Mm]akefile&quot;</span>,
        <span class="string">&quot;[Gg][Nn][Uu]makefile.am&quot;</span>, <span class="string">&quot;[Mm]akefile.am&quot;</span>,
        <span class="string">&quot;[Gg][Nn][Uu]makefile.in&quot;</span>, <span class="string">&quot;[Mm]akefile.in&quot;</span>,
        <span class="string">&quot;*.mk&quot;</span>, <span class="string">&quot;*.mak&quot;</span>
    ]),
    (<span class="string">&quot;mako&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.mako&quot;</span>, <span class="string">&quot;*.mao&quot;</span>]),
    (<span class="string">&quot;markdown&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.markdown&quot;</span>, <span class="string">&quot;*.md&quot;</span>, <span class="string">&quot;*.mdown&quot;</span>, <span class="string">&quot;*.mkdn&quot;</span>]),
    (<span class="string">&quot;md&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.markdown&quot;</span>, <span class="string">&quot;*.md&quot;</span>, <span class="string">&quot;*.mdown&quot;</span>, <span class="string">&quot;*.mkdn&quot;</span>]),
    (<span class="string">&quot;man&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.[0-9lnpx]&quot;</span>, <span class="string">&quot;*.[0-9][cEFMmpSx]&quot;</span>]),
    (<span class="string">&quot;matlab&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.m&quot;</span>]),
    (<span class="string">&quot;mk&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;mkfile&quot;</span>]),
    (<span class="string">&quot;ml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ml&quot;</span>]),
    (<span class="string">&quot;msbuild&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;*.csproj&quot;</span>, <span class="string">&quot;*.fsproj&quot;</span>, <span class="string">&quot;*.vcxproj&quot;</span>, <span class="string">&quot;*.proj&quot;</span>, <span class="string">&quot;*.props&quot;</span>, <span class="string">&quot;*.targets&quot;</span>
    ]),
    (<span class="string">&quot;nim&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.nim&quot;</span>, <span class="string">&quot;*.nimf&quot;</span>, <span class="string">&quot;*.nimble&quot;</span>, <span class="string">&quot;*.nims&quot;</span>]),
    (<span class="string">&quot;nix&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.nix&quot;</span>]),
    (<span class="string">&quot;objc&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.h&quot;</span>, <span class="string">&quot;*.m&quot;</span>]),
    (<span class="string">&quot;objcpp&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.h&quot;</span>, <span class="string">&quot;*.mm&quot;</span>]),
    (<span class="string">&quot;ocaml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ml&quot;</span>, <span class="string">&quot;*.mli&quot;</span>, <span class="string">&quot;*.mll&quot;</span>, <span class="string">&quot;*.mly&quot;</span>]),
    (<span class="string">&quot;org&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.org&quot;</span>]),
    (<span class="string">&quot;pascal&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.pas&quot;</span>, <span class="string">&quot;*.dpr&quot;</span>, <span class="string">&quot;*.lpr&quot;</span>, <span class="string">&quot;*.pp&quot;</span>, <span class="string">&quot;*.inc&quot;</span>]),
    (<span class="string">&quot;perl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.perl&quot;</span>, <span class="string">&quot;*.pl&quot;</span>, <span class="string">&quot;*.PL&quot;</span>, <span class="string">&quot;*.plh&quot;</span>, <span class="string">&quot;*.plx&quot;</span>, <span class="string">&quot;*.pm&quot;</span>, <span class="string">&quot;*.t&quot;</span>]),
    (<span class="string">&quot;pdf&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.pdf&quot;</span>]),
    (<span class="string">&quot;php&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.php&quot;</span>, <span class="string">&quot;*.php3&quot;</span>, <span class="string">&quot;*.php4&quot;</span>, <span class="string">&quot;*.php5&quot;</span>, <span class="string">&quot;*.phtml&quot;</span>]),
    (<span class="string">&quot;pod&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.pod&quot;</span>]),
    (<span class="string">&quot;postscript&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;.eps&quot;</span>, <span class="string">&quot;.ps&quot;</span>]),
    (<span class="string">&quot;protobuf&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.proto&quot;</span>]),
    (<span class="string">&quot;ps&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.cdxml&quot;</span>, <span class="string">&quot;*.ps1&quot;</span>, <span class="string">&quot;*.ps1xml&quot;</span>, <span class="string">&quot;*.psd1&quot;</span>, <span class="string">&quot;*.psm1&quot;</span>]),
    (<span class="string">&quot;puppet&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.erb&quot;</span>, <span class="string">&quot;*.pp&quot;</span>, <span class="string">&quot;*.rb&quot;</span>]),
    (<span class="string">&quot;purs&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.purs&quot;</span>]),
    (<span class="string">&quot;py&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.py&quot;</span>]),
    (<span class="string">&quot;qmake&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.pro&quot;</span>, <span class="string">&quot;*.pri&quot;</span>, <span class="string">&quot;*.prf&quot;</span>]),
    (<span class="string">&quot;qml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.qml&quot;</span>]),
    (<span class="string">&quot;readme&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;README*&quot;</span>, <span class="string">&quot;*README&quot;</span>]),
    (<span class="string">&quot;r&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.R&quot;</span>, <span class="string">&quot;*.r&quot;</span>, <span class="string">&quot;*.Rmd&quot;</span>, <span class="string">&quot;*.Rnw&quot;</span>]),
    (<span class="string">&quot;rdoc&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.rdoc&quot;</span>]),
    (<span class="string">&quot;robot&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.robot&quot;</span>]),
    (<span class="string">&quot;rst&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.rst&quot;</span>]),
    (<span class="string">&quot;ruby&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;Gemfile&quot;</span>, <span class="string">&quot;*.gemspec&quot;</span>, <span class="string">&quot;.irbrc&quot;</span>, <span class="string">&quot;Rakefile&quot;</span>, <span class="string">&quot;*.rb&quot;</span>]),
    (<span class="string">&quot;rust&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.rs&quot;</span>]),
    (<span class="string">&quot;sass&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.sass&quot;</span>, <span class="string">&quot;*.scss&quot;</span>]),
    (<span class="string">&quot;scala&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.scala&quot;</span>, <span class="string">&quot;*.sbt&quot;</span>]),
    (<span class="string">&quot;sh&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="comment">// Portable/misc. init files</span>
        <span class="string">&quot;.login&quot;</span>, <span class="string">&quot;.logout&quot;</span>, <span class="string">&quot;.profile&quot;</span>, <span class="string">&quot;profile&quot;</span>,
        <span class="comment">// bash-specific init files</span>
        <span class="string">&quot;.bash_login&quot;</span>, <span class="string">&quot;bash_login&quot;</span>,
        <span class="string">&quot;.bash_logout&quot;</span>, <span class="string">&quot;bash_logout&quot;</span>,
        <span class="string">&quot;.bash_profile&quot;</span>, <span class="string">&quot;bash_profile&quot;</span>,
        <span class="string">&quot;.bashrc&quot;</span>, <span class="string">&quot;bashrc&quot;</span>, <span class="string">&quot;*.bashrc&quot;</span>,
        <span class="comment">// csh-specific init files</span>
        <span class="string">&quot;.cshrc&quot;</span>, <span class="string">&quot;*.cshrc&quot;</span>,
        <span class="comment">// ksh-specific init files</span>
        <span class="string">&quot;.kshrc&quot;</span>, <span class="string">&quot;*.kshrc&quot;</span>,
        <span class="comment">// tcsh-specific init files</span>
        <span class="string">&quot;.tcshrc&quot;</span>,
        <span class="comment">// zsh-specific init files</span>
        <span class="string">&quot;.zshenv&quot;</span>, <span class="string">&quot;zshenv&quot;</span>,
        <span class="string">&quot;.zlogin&quot;</span>, <span class="string">&quot;zlogin&quot;</span>,
        <span class="string">&quot;.zlogout&quot;</span>, <span class="string">&quot;zlogout&quot;</span>,
        <span class="string">&quot;.zprofile&quot;</span>, <span class="string">&quot;zprofile&quot;</span>,
        <span class="string">&quot;.zshrc&quot;</span>, <span class="string">&quot;zshrc&quot;</span>,
        <span class="comment">// Extensions</span>
        <span class="string">&quot;*.bash&quot;</span>, <span class="string">&quot;*.csh&quot;</span>, <span class="string">&quot;*.ksh&quot;</span>, <span class="string">&quot;*.sh&quot;</span>, <span class="string">&quot;*.tcsh&quot;</span>, <span class="string">&quot;*.zsh&quot;</span>,
    ]),
    (<span class="string">&quot;smarty&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.tpl&quot;</span>]),
    (<span class="string">&quot;sml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.sml&quot;</span>, <span class="string">&quot;*.sig&quot;</span>]),
    (<span class="string">&quot;soy&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.soy&quot;</span>]),
    (<span class="string">&quot;spark&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.spark&quot;</span>]),
    (<span class="string">&quot;sql&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.sql&quot;</span>, <span class="string">&quot;*.psql&quot;</span>]),
    (<span class="string">&quot;stylus&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.styl&quot;</span>]),
    (<span class="string">&quot;sv&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.v&quot;</span>, <span class="string">&quot;*.vg&quot;</span>, <span class="string">&quot;*.sv&quot;</span>, <span class="string">&quot;*.svh&quot;</span>, <span class="string">&quot;*.h&quot;</span>]),
    (<span class="string">&quot;svg&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.svg&quot;</span>]),
    (<span class="string">&quot;swift&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.swift&quot;</span>]),
    (<span class="string">&quot;swig&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.def&quot;</span>, <span class="string">&quot;*.i&quot;</span>]),
    (<span class="string">&quot;systemd&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;*.automount&quot;</span>, <span class="string">&quot;*.conf&quot;</span>, <span class="string">&quot;*.device&quot;</span>, <span class="string">&quot;*.link&quot;</span>, <span class="string">&quot;*.mount&quot;</span>, <span class="string">&quot;*.path&quot;</span>,
        <span class="string">&quot;*.scope&quot;</span>, <span class="string">&quot;*.service&quot;</span>, <span class="string">&quot;*.slice&quot;</span>, <span class="string">&quot;*.socket&quot;</span>, <span class="string">&quot;*.swap&quot;</span>, <span class="string">&quot;*.target&quot;</span>,
        <span class="string">&quot;*.timer&quot;</span>,
    ]),
    (<span class="string">&quot;taskpaper&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.taskpaper&quot;</span>]),
    (<span class="string">&quot;tcl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.tcl&quot;</span>]),
    (<span class="string">&quot;tex&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.tex&quot;</span>, <span class="string">&quot;*.ltx&quot;</span>, <span class="string">&quot;*.cls&quot;</span>, <span class="string">&quot;*.sty&quot;</span>, <span class="string">&quot;*.bib&quot;</span>, <span class="string">&quot;*.dtx&quot;</span>, <span class="string">&quot;*.ins&quot;</span>]),
    (<span class="string">&quot;textile&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.textile&quot;</span>]),
    (<span class="string">&quot;thrift&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.thrift&quot;</span>]),
    (<span class="string">&quot;tf&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.tf&quot;</span>]),
    (<span class="string">&quot;ts&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.ts&quot;</span>, <span class="string">&quot;*.tsx&quot;</span>]),
    (<span class="string">&quot;txt&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.txt&quot;</span>]),
    (<span class="string">&quot;toml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.toml&quot;</span>, <span class="string">&quot;Cargo.lock&quot;</span>]),
    (<span class="string">&quot;twig&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.twig&quot;</span>]),
    (<span class="string">&quot;vala&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.vala&quot;</span>]),
    (<span class="string">&quot;vb&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.vb&quot;</span>]),
    (<span class="string">&quot;verilog&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.v&quot;</span>, <span class="string">&quot;*.vh&quot;</span>, <span class="string">&quot;*.sv&quot;</span>, <span class="string">&quot;*.svh&quot;</span>]),
    (<span class="string">&quot;vhdl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.vhd&quot;</span>, <span class="string">&quot;*.vhdl&quot;</span>]),
    (<span class="string">&quot;vim&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.vim&quot;</span>]),
    (<span class="string">&quot;vimscript&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.vim&quot;</span>]),
    (<span class="string">&quot;wiki&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.mediawiki&quot;</span>, <span class="string">&quot;*.wiki&quot;</span>]),
    (<span class="string">&quot;webidl&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.idl&quot;</span>, <span class="string">&quot;*.webidl&quot;</span>, <span class="string">&quot;*.widl&quot;</span>]),
    (<span class="string">&quot;xml&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;*.xml&quot;</span>, <span class="string">&quot;*.xml.dist&quot;</span>, <span class="string">&quot;*.dtd&quot;</span>, <span class="string">&quot;*.xsl&quot;</span>, <span class="string">&quot;*.xslt&quot;</span>, <span class="string">&quot;*.xsd&quot;</span>, <span class="string">&quot;*.xjb&quot;</span>,
        <span class="string">&quot;*.rng&quot;</span>, <span class="string">&quot;*.sch&quot;</span>,
    ]),
    (<span class="string">&quot;xz&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.xz&quot;</span>, <span class="string">&quot;*.txz&quot;</span>]),
    (<span class="string">&quot;yacc&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.y&quot;</span>]),
    (<span class="string">&quot;yaml&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.yaml&quot;</span>, <span class="string">&quot;*.yml&quot;</span>]),
    (<span class="string">&quot;zig&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.zig&quot;</span>]),
    (<span class="string">&quot;zsh&quot;</span>, <span class="kw-2">&amp;</span>[
        <span class="string">&quot;.zshenv&quot;</span>, <span class="string">&quot;zshenv&quot;</span>,
        <span class="string">&quot;.zlogin&quot;</span>, <span class="string">&quot;zlogin&quot;</span>,
        <span class="string">&quot;.zlogout&quot;</span>, <span class="string">&quot;zlogout&quot;</span>,
        <span class="string">&quot;.zprofile&quot;</span>, <span class="string">&quot;zprofile&quot;</span>,
        <span class="string">&quot;.zshrc&quot;</span>, <span class="string">&quot;zshrc&quot;</span>,
        <span class="string">&quot;*.zsh&quot;</span>,
    ]),
    (<span class="string">&quot;zstd&quot;</span>, <span class="kw-2">&amp;</span>[<span class="string">&quot;*.zst&quot;</span>, <span class="string">&quot;*.zstd&quot;</span>]),
];

<span class="doccomment">/// Glob represents a single glob in a set of file type definitions.</span>
<span class="doccomment">///</span>
<span class="doccomment">/// There may be more than one glob for a particular file type.</span>
<span class="doccomment">///</span>
<span class="doccomment">/// This is used to report information about the highest precedent glob</span>
<span class="doccomment">/// that matched.</span>
<span class="doccomment">///</span>
<span class="doccomment">/// Note that not all matches necessarily correspond to a specific glob.</span>
<span class="doccomment">/// For example, if there are one or more selections and a file path doesn&#39;t</span>
<span class="doccomment">/// match any of those selections, then the file path is considered to be</span>
<span class="doccomment">/// ignored.</span>
<span class="doccomment">///</span>
<span class="doccomment">/// The lifetime `&#39;a` refers to the lifetime of the underlying file type</span>
<span class="doccomment">/// definition, which corresponds to the lifetime of the file type matcher.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Clone</span>, <span class="ident">Debug</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">Glob</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span>(<span class="ident">GlobInner</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span>);

<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Clone</span>, <span class="ident">Debug</span>)]</span>
<span class="kw">enum</span> <span class="ident">GlobInner</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span> {
    <span class="doccomment">/// No glob matched, but the file path should still be ignored.</span>
    <span class="ident">UnmatchedIgnore</span>,
    <span class="doccomment">/// A glob matched.</span>
    <span class="ident">Matched</span> {
        <span class="doccomment">/// The file type definition which provided the glob.</span>
        <span class="ident">def</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;a</span> <span class="ident">FileTypeDef</span>,
        <span class="doccomment">/// The index of the glob that matched inside the file type definition.</span>
        <span class="ident">which</span>: <span class="ident">usize</span>,
        <span class="doccomment">/// Whether the selection was negated or not.</span>
        <span class="ident">negated</span>: <span class="ident">bool</span>,
    }
}

<span class="kw">impl</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span> <span class="ident">Glob</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span> {
    <span class="kw">fn</span> <span class="ident">unmatched</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Glob</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span> {
        <span class="ident">Glob</span>(<span class="ident">GlobInner</span>::<span class="ident">UnmatchedIgnore</span>)
    }

    <span class="doccomment">/// Return the file type defintion that matched, if one exists. A file type</span>
    <span class="doccomment">/// definition always exists when a specific definition matches a file</span>
    <span class="doccomment">/// path.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">file_type_def</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Option</span><span class="op">&lt;</span><span class="kw-2">&amp;</span><span class="ident">FileTypeDef</span><span class="op">&gt;</span> {
        <span class="kw">match</span> <span class="self">self</span> {
            <span class="ident">Glob</span>(<span class="ident">GlobInner</span>::<span class="ident">UnmatchedIgnore</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="prelude-val">None</span>,
            <span class="ident">Glob</span>(<span class="ident">GlobInner</span>::<span class="ident">Matched</span> { <span class="ident">def</span>, .. }) <span class="op">=</span><span class="op">&gt;</span> {
                <span class="prelude-val">Some</span>(<span class="ident">def</span>)
            },
        }
    }
}

<span class="doccomment">/// A single file type definition.</span>
<span class="doccomment">///</span>
<span class="doccomment">/// File type definitions can be retrieved in aggregate from a file type</span>
<span class="doccomment">/// matcher. File type definitions are also reported when its responsible</span>
<span class="doccomment">/// for a match.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Clone</span>, <span class="ident">Debug</span>, <span class="ident">Eq</span>, <span class="ident">PartialEq</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">FileTypeDef</span> {
    <span class="ident">name</span>: <span class="ident">String</span>,
    <span class="ident">globs</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">String</span><span class="op">&gt;</span>,
}

<span class="kw">impl</span> <span class="ident">FileTypeDef</span> {
    <span class="doccomment">/// Return the name of this file type.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">name</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="ident">str</span> {
        <span class="kw-2">&amp;</span><span class="self">self</span>.<span class="ident">name</span>
    }

    <span class="doccomment">/// Return the globs used to recognize this file type.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">globs</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span>[<span class="ident">String</span>] {
        <span class="kw-2">&amp;</span><span class="self">self</span>.<span class="ident">globs</span>
    }
}

<span class="doccomment">/// Types is a file type matcher.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Clone</span>, <span class="ident">Debug</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">Types</span> {
    <span class="doccomment">/// All of the file type definitions, sorted lexicographically by name.</span>
    <span class="ident">defs</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">FileTypeDef</span><span class="op">&gt;</span>,
    <span class="doccomment">/// All of the selections made by the user.</span>
    <span class="ident">selections</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">Selection</span><span class="op">&lt;</span><span class="ident">FileTypeDef</span><span class="op">&gt;</span><span class="op">&gt;</span>,
    <span class="doccomment">/// Whether there is at least one Selection::Select in our selections.</span>
    <span class="doccomment">/// When this is true, a Match::None is converted to Match::Ignore.</span>
    <span class="ident">has_selected</span>: <span class="ident">bool</span>,
    <span class="doccomment">/// A mapping from glob index in the set to two indices. The first is an</span>
    <span class="doccomment">/// index into `selections` and the second is an index into the</span>
    <span class="doccomment">/// corresponding file type definition&#39;s list of globs.</span>
    <span class="ident">glob_to_selection</span>: <span class="ident">Vec</span><span class="op">&lt;</span>(<span class="ident">usize</span>, <span class="ident">usize</span>)<span class="op">&gt;</span>,
    <span class="doccomment">/// The set of all glob selections, used for actual matching.</span>
    <span class="ident">set</span>: <span class="ident">GlobSet</span>,
    <span class="doccomment">/// Temporary storage for globs that match.</span>
    <span class="ident">matches</span>: <span class="ident">Arc</span><span class="op">&lt;</span><span class="ident">ThreadLocal</span><span class="op">&lt;</span><span class="ident">RefCell</span><span class="op">&lt;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">usize</span><span class="op">&gt;</span><span class="op">&gt;</span><span class="op">&gt;</span><span class="op">&gt;</span>,
}

<span class="doccomment">/// Indicates the type of a selection for a particular file type.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Clone</span>, <span class="ident">Debug</span>)]</span>
<span class="kw">enum</span> <span class="ident">Selection</span><span class="op">&lt;</span><span class="ident">T</span><span class="op">&gt;</span> {
    <span class="ident">Select</span>(<span class="ident">String</span>, <span class="ident">T</span>),
    <span class="ident">Negate</span>(<span class="ident">String</span>, <span class="ident">T</span>),
}

<span class="kw">impl</span><span class="op">&lt;</span><span class="ident">T</span><span class="op">&gt;</span> <span class="ident">Selection</span><span class="op">&lt;</span><span class="ident">T</span><span class="op">&gt;</span> {
    <span class="kw">fn</span> <span class="ident">is_negated</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">bool</span> {
        <span class="kw">match</span> <span class="kw-2">*</span><span class="self">self</span> {
            <span class="ident">Selection</span>::<span class="ident">Select</span>(..) <span class="op">=</span><span class="op">&gt;</span> <span class="bool-val">false</span>,
            <span class="ident">Selection</span>::<span class="ident">Negate</span>(..) <span class="op">=</span><span class="op">&gt;</span> <span class="bool-val">true</span>,
        }
    }

    <span class="kw">fn</span> <span class="ident">name</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="ident">str</span> {
        <span class="kw">match</span> <span class="kw-2">*</span><span class="self">self</span> {
            <span class="ident">Selection</span>::<span class="ident">Select</span>(<span class="kw-2">ref</span> <span class="ident">name</span>, <span class="kw">_</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="ident">name</span>,
            <span class="ident">Selection</span>::<span class="ident">Negate</span>(<span class="kw-2">ref</span> <span class="ident">name</span>, <span class="kw">_</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="ident">name</span>,
        }
    }

    <span class="kw">fn</span> <span class="ident">map</span><span class="op">&lt;</span><span class="ident">U</span>, <span class="ident">F</span>: <span class="ident">FnOnce</span>(<span class="ident">T</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">U</span><span class="op">&gt;</span>(<span class="self">self</span>, <span class="ident">f</span>: <span class="ident">F</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Selection</span><span class="op">&lt;</span><span class="ident">U</span><span class="op">&gt;</span> {
        <span class="kw">match</span> <span class="self">self</span> {
            <span class="ident">Selection</span>::<span class="ident">Select</span>(<span class="ident">name</span>, <span class="ident">inner</span>) <span class="op">=</span><span class="op">&gt;</span> {
                <span class="ident">Selection</span>::<span class="ident">Select</span>(<span class="ident">name</span>, <span class="ident">f</span>(<span class="ident">inner</span>))
            }
            <span class="ident">Selection</span>::<span class="ident">Negate</span>(<span class="ident">name</span>, <span class="ident">inner</span>) <span class="op">=</span><span class="op">&gt;</span> {
                <span class="ident">Selection</span>::<span class="ident">Negate</span>(<span class="ident">name</span>, <span class="ident">f</span>(<span class="ident">inner</span>))
            }
        }
    }

    <span class="kw">fn</span> <span class="ident">inner</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="ident">T</span> {
        <span class="kw">match</span> <span class="kw-2">*</span><span class="self">self</span> {
            <span class="ident">Selection</span>::<span class="ident">Select</span>(<span class="kw">_</span>, <span class="kw-2">ref</span> <span class="ident">inner</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="ident">inner</span>,
            <span class="ident">Selection</span>::<span class="ident">Negate</span>(<span class="kw">_</span>, <span class="kw-2">ref</span> <span class="ident">inner</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="ident">inner</span>,
        }
    }
}

<span class="kw">impl</span> <span class="ident">Types</span> {
    <span class="doccomment">/// Creates a new file type matcher that never matches any path and</span>
    <span class="doccomment">/// contains no file type definitions.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">empty</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Types</span> {
        <span class="ident">Types</span> {
            <span class="ident">defs</span>: <span class="macro">vec</span><span class="macro">!</span>[],
            <span class="ident">selections</span>: <span class="macro">vec</span><span class="macro">!</span>[],
            <span class="ident">has_selected</span>: <span class="bool-val">false</span>,
            <span class="ident">glob_to_selection</span>: <span class="macro">vec</span><span class="macro">!</span>[],
            <span class="ident">set</span>: <span class="ident">GlobSetBuilder</span>::<span class="ident">new</span>().<span class="ident">build</span>().<span class="ident">unwrap</span>(),
            <span class="ident">matches</span>: <span class="ident">Arc</span>::<span class="ident">new</span>(<span class="ident">ThreadLocal</span>::<span class="ident">default</span>()),
        }
    }

    <span class="doccomment">/// Returns true if and only if this matcher has zero selections.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">is_empty</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">bool</span> {
        <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">is_empty</span>()
    }

    <span class="doccomment">/// Returns the number of selections used in this matcher.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">len</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">usize</span> {
        <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">len</span>()
    }

    <span class="doccomment">/// Return the set of current file type definitions.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// Definitions and globs are sorted.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">definitions</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span>[<span class="ident">FileTypeDef</span>] {
        <span class="kw-2">&amp;</span><span class="self">self</span>.<span class="ident">defs</span>
    }

    <span class="doccomment">/// Returns a match for the given path against this file type matcher.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// The path is considered whitelisted if it matches a selected file type.</span>
    <span class="doccomment">/// The path is considered ignored if it matches a negated file type.</span>
    <span class="doccomment">/// If at least one file type is selected and `path` doesn&#39;t match, then</span>
    <span class="doccomment">/// the path is also considered ignored.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">matched</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="ident">P</span>: <span class="ident">AsRef</span><span class="op">&lt;</span><span class="ident">Path</span><span class="op">&gt;</span><span class="op">&gt;</span>(
        <span class="kw-2">&amp;</span><span class="lifetime">&#39;a</span> <span class="self">self</span>,
        <span class="ident">path</span>: <span class="ident">P</span>,
        <span class="ident">is_dir</span>: <span class="ident">bool</span>,
    ) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Match</span><span class="op">&lt;</span><span class="ident">Glob</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span><span class="op">&gt;</span> {
        <span class="comment">// File types don&#39;t apply to directories, and we can&#39;t do anything</span>
        <span class="comment">// if our glob set is empty.</span>
        <span class="kw">if</span> <span class="ident">is_dir</span> <span class="op">|</span><span class="op">|</span> <span class="self">self</span>.<span class="ident">set</span>.<span class="ident">is_empty</span>() {
            <span class="kw">return</span> <span class="ident">Match</span>::<span class="prelude-val">None</span>;
        }
        <span class="comment">// We only want to match against the file name, so extract it.</span>
        <span class="comment">// If one doesn&#39;t exist, then we can&#39;t match it.</span>
        <span class="kw">let</span> <span class="ident">name</span> <span class="op">=</span> <span class="kw">match</span> <span class="ident">file_name</span>(<span class="ident">path</span>.<span class="ident">as_ref</span>()) {
            <span class="prelude-val">Some</span>(<span class="ident">name</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="ident">name</span>,
            <span class="prelude-val">None</span> <span class="kw">if</span> <span class="self">self</span>.<span class="ident">has_selected</span> <span class="op">=</span><span class="op">&gt;</span> {
                <span class="kw">return</span> <span class="ident">Match</span>::<span class="ident">Ignore</span>(<span class="ident">Glob</span>::<span class="ident">unmatched</span>());
            }
            <span class="prelude-val">None</span> <span class="op">=</span><span class="op">&gt;</span> {
                <span class="kw">return</span> <span class="ident">Match</span>::<span class="prelude-val">None</span>;
            }
        };
        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">matches</span> <span class="op">=</span> <span class="self">self</span>.<span class="ident">matches</span>.<span class="ident">get_default</span>().<span class="ident">borrow_mut</span>();
        <span class="self">self</span>.<span class="ident">set</span>.<span class="ident">matches_into</span>(<span class="ident">name</span>, <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="kw-2">*</span><span class="ident">matches</span>);
        <span class="comment">// The highest precedent match is the last one.</span>
        <span class="kw">if</span> <span class="kw">let</span> <span class="prelude-val">Some</span>(<span class="kw-2">&amp;</span><span class="ident">i</span>) <span class="op">=</span> <span class="ident">matches</span>.<span class="ident">last</span>() {
            <span class="kw">let</span> (<span class="ident">isel</span>, <span class="ident">iglob</span>) <span class="op">=</span> <span class="self">self</span>.<span class="ident">glob_to_selection</span>[<span class="ident">i</span>];
            <span class="kw">let</span> <span class="ident">sel</span> <span class="op">=</span> <span class="kw-2">&amp;</span><span class="self">self</span>.<span class="ident">selections</span>[<span class="ident">isel</span>];
            <span class="kw">let</span> <span class="ident">glob</span> <span class="op">=</span> <span class="ident">Glob</span>(<span class="ident">GlobInner</span>::<span class="ident">Matched</span> {
                <span class="ident">def</span>: <span class="ident">sel</span>.<span class="ident">inner</span>(),
                <span class="ident">which</span>: <span class="ident">iglob</span>,
                <span class="ident">negated</span>: <span class="ident">sel</span>.<span class="ident">is_negated</span>(),
            });
            <span class="kw">return</span> <span class="kw">if</span> <span class="ident">sel</span>.<span class="ident">is_negated</span>() {
                <span class="ident">Match</span>::<span class="ident">Ignore</span>(<span class="ident">glob</span>)
            } <span class="kw">else</span> {
                <span class="ident">Match</span>::<span class="ident">Whitelist</span>(<span class="ident">glob</span>)
            };
        }
        <span class="kw">if</span> <span class="self">self</span>.<span class="ident">has_selected</span> {
            <span class="ident">Match</span>::<span class="ident">Ignore</span>(<span class="ident">Glob</span>::<span class="ident">unmatched</span>())
        } <span class="kw">else</span> {
            <span class="ident">Match</span>::<span class="prelude-val">None</span>
        }
    }
}

<span class="doccomment">/// TypesBuilder builds a type matcher from a set of file type definitions and</span>
<span class="doccomment">/// a set of file type selections.</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">TypesBuilder</span> {
    <span class="ident">types</span>: <span class="ident">HashMap</span><span class="op">&lt;</span><span class="ident">String</span>, <span class="ident">FileTypeDef</span><span class="op">&gt;</span>,
    <span class="ident">selections</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">Selection</span><span class="op">&lt;</span>()<span class="op">&gt;</span><span class="op">&gt;</span>,
}

<span class="kw">impl</span> <span class="ident">TypesBuilder</span> {
    <span class="doccomment">/// Create a new builder for a file type matcher.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// The builder contains *no* type definitions to start with. A set</span>
    <span class="doccomment">/// of default type definitions can be added with `add_defaults`, and</span>
    <span class="doccomment">/// additional type definitions can be added with `select` and `negate`.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">new</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="ident">TypesBuilder</span> {
        <span class="ident">TypesBuilder</span> {
            <span class="ident">types</span>: <span class="ident">HashMap</span>::<span class="ident">new</span>(),
            <span class="ident">selections</span>: <span class="macro">vec</span><span class="macro">!</span>[],
        }
    }

    <span class="doccomment">/// Build the current set of file type definitions *and* selections into</span>
    <span class="doccomment">/// a file type matcher.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">build</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">Types</span>, <span class="ident">Error</span><span class="op">&gt;</span> {
        <span class="kw">let</span> <span class="ident">defs</span> <span class="op">=</span> <span class="self">self</span>.<span class="ident">definitions</span>();
        <span class="kw">let</span> <span class="ident">has_selected</span> <span class="op">=</span> <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">iter</span>().<span class="ident">any</span>(<span class="op">|</span><span class="ident">s</span><span class="op">|</span> <span class="op">!</span><span class="ident">s</span>.<span class="ident">is_negated</span>());

        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">selections</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[];
        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">glob_to_selection</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[];
        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">build_set</span> <span class="op">=</span> <span class="ident">GlobSetBuilder</span>::<span class="ident">new</span>();
        <span class="kw">for</span> (<span class="ident">isel</span>, <span class="ident">selection</span>) <span class="kw">in</span> <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">iter</span>().<span class="ident">enumerate</span>() {
            <span class="kw">let</span> <span class="ident">def</span> <span class="op">=</span> <span class="kw">match</span> <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">get</span>(<span class="ident">selection</span>.<span class="ident">name</span>()) {
                <span class="prelude-val">Some</span>(<span class="ident">def</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="ident">def</span>.<span class="ident">clone</span>(),
                <span class="prelude-val">None</span> <span class="op">=</span><span class="op">&gt;</span> {
                    <span class="kw">let</span> <span class="ident">name</span> <span class="op">=</span> <span class="ident">selection</span>.<span class="ident">name</span>().<span class="ident">to_string</span>();
                    <span class="kw">return</span> <span class="prelude-val">Err</span>(<span class="ident">Error</span>::<span class="ident">UnrecognizedFileType</span>(<span class="ident">name</span>));
                }
            };
            <span class="kw">for</span> (<span class="ident">iglob</span>, <span class="ident">glob</span>) <span class="kw">in</span> <span class="ident">def</span>.<span class="ident">globs</span>.<span class="ident">iter</span>().<span class="ident">enumerate</span>() {
                <span class="ident">build_set</span>.<span class="ident">add</span>(
                    <span class="ident">GlobBuilder</span>::<span class="ident">new</span>(<span class="ident">glob</span>)
                        .<span class="ident">literal_separator</span>(<span class="bool-val">true</span>)
                        .<span class="ident">build</span>()
                        .<span class="ident">map_err</span>(<span class="op">|</span><span class="ident">err</span><span class="op">|</span> {
                            <span class="ident">Error</span>::<span class="ident">Glob</span> {
                                <span class="ident">glob</span>: <span class="prelude-val">Some</span>(<span class="ident">glob</span>.<span class="ident">to_string</span>()),
                                <span class="ident">err</span>: <span class="ident">err</span>.<span class="ident">kind</span>().<span class="ident">to_string</span>(),
                            }
                        })<span class="question-mark">?</span>);
                <span class="ident">glob_to_selection</span>.<span class="ident">push</span>((<span class="ident">isel</span>, <span class="ident">iglob</span>));
            }
            <span class="ident">selections</span>.<span class="ident">push</span>(<span class="ident">selection</span>.<span class="ident">clone</span>().<span class="ident">map</span>(<span class="kw">move</span> <span class="op">|</span><span class="kw">_</span><span class="op">|</span> <span class="ident">def</span>));
        }
        <span class="kw">let</span> <span class="ident">set</span> <span class="op">=</span> <span class="ident">build_set</span>.<span class="ident">build</span>().<span class="ident">map_err</span>(<span class="op">|</span><span class="ident">err</span><span class="op">|</span> {
            <span class="ident">Error</span>::<span class="ident">Glob</span> { <span class="ident">glob</span>: <span class="prelude-val">None</span>, <span class="ident">err</span>: <span class="ident">err</span>.<span class="ident">to_string</span>() }
        })<span class="question-mark">?</span>;
        <span class="prelude-val">Ok</span>(<span class="ident">Types</span> {
            <span class="ident">defs</span>: <span class="ident">defs</span>,
            <span class="ident">selections</span>: <span class="ident">selections</span>,
            <span class="ident">has_selected</span>: <span class="ident">has_selected</span>,
            <span class="ident">glob_to_selection</span>: <span class="ident">glob_to_selection</span>,
            <span class="ident">set</span>: <span class="ident">set</span>,
            <span class="ident">matches</span>: <span class="ident">Arc</span>::<span class="ident">new</span>(<span class="ident">ThreadLocal</span>::<span class="ident">default</span>()),
        })
    }

    <span class="doccomment">/// Return the set of current file type definitions.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// Definitions and globs are sorted.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">definitions</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">FileTypeDef</span><span class="op">&gt;</span> {
        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">defs</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[];
        <span class="kw">for</span> <span class="ident">def</span> <span class="kw">in</span> <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">values</span>() {
            <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">def</span> <span class="op">=</span> <span class="ident">def</span>.<span class="ident">clone</span>();
            <span class="ident">def</span>.<span class="ident">globs</span>.<span class="ident">sort</span>();
            <span class="ident">defs</span>.<span class="ident">push</span>(<span class="ident">def</span>);
        }
        <span class="ident">defs</span>.<span class="ident">sort_by</span>(<span class="op">|</span><span class="ident">def1</span>, <span class="ident">def2</span><span class="op">|</span> <span class="ident">def1</span>.<span class="ident">name</span>().<span class="ident">cmp</span>(<span class="ident">def2</span>.<span class="ident">name</span>()));
        <span class="ident">defs</span>
    }

    <span class="doccomment">/// Select the file type given by `name`.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// If `name` is `all`, then all file types currently defined are selected.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">select</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">self</span>, <span class="ident">name</span>: <span class="kw-2">&amp;</span><span class="ident">str</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">TypesBuilder</span> {
        <span class="kw">if</span> <span class="ident">name</span> <span class="op">=</span><span class="op">=</span> <span class="string">&quot;all&quot;</span> {
            <span class="kw">for</span> <span class="ident">name</span> <span class="kw">in</span> <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">keys</span>() {
                <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">push</span>(<span class="ident">Selection</span>::<span class="ident">Select</span>(<span class="ident">name</span>.<span class="ident">to_string</span>(), ()));
            }
        } <span class="kw">else</span> {
            <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">push</span>(<span class="ident">Selection</span>::<span class="ident">Select</span>(<span class="ident">name</span>.<span class="ident">to_string</span>(), ()));
        }
        <span class="self">self</span>
    }

    <span class="doccomment">/// Ignore the file type given by `name`.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// If `name` is `all`, then all file types currently defined are negated.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">negate</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">self</span>, <span class="ident">name</span>: <span class="kw-2">&amp;</span><span class="ident">str</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">TypesBuilder</span> {
        <span class="kw">if</span> <span class="ident">name</span> <span class="op">=</span><span class="op">=</span> <span class="string">&quot;all&quot;</span> {
            <span class="kw">for</span> <span class="ident">name</span> <span class="kw">in</span> <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">keys</span>() {
                <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">push</span>(<span class="ident">Selection</span>::<span class="ident">Negate</span>(<span class="ident">name</span>.<span class="ident">to_string</span>(), ()));
            }
        } <span class="kw">else</span> {
            <span class="self">self</span>.<span class="ident">selections</span>.<span class="ident">push</span>(<span class="ident">Selection</span>::<span class="ident">Negate</span>(<span class="ident">name</span>.<span class="ident">to_string</span>(), ()));
        }
        <span class="self">self</span>
    }

    <span class="doccomment">/// Clear any file type definitions for the type name given.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">clear</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">self</span>, <span class="ident">name</span>: <span class="kw-2">&amp;</span><span class="ident">str</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">TypesBuilder</span> {
        <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">remove</span>(<span class="ident">name</span>);
        <span class="self">self</span>
    }

    <span class="doccomment">/// Add a new file type definition. `name` can be arbitrary and `pat`</span>
    <span class="doccomment">/// should be a glob recognizing file paths belonging to the `name` type.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// If `name` is `all` or otherwise contains any character that is not a</span>
    <span class="doccomment">/// Unicode letter or number, then an error is returned.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">add</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">self</span>, <span class="ident">name</span>: <span class="kw-2">&amp;</span><span class="ident">str</span>, <span class="ident">glob</span>: <span class="kw-2">&amp;</span><span class="ident">str</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Error</span><span class="op">&gt;</span> {
        <span class="macro">lazy_static</span><span class="macro">!</span> {
            <span class="kw">static</span> <span class="kw-2">ref</span> <span class="ident">RE</span>: <span class="ident">Regex</span> <span class="op">=</span> <span class="ident">Regex</span>::<span class="ident">new</span>(<span class="string">r&quot;^[\pL\pN]+$&quot;</span>).<span class="ident">unwrap</span>();
        };
        <span class="kw">if</span> <span class="ident">name</span> <span class="op">=</span><span class="op">=</span> <span class="string">&quot;all&quot;</span> <span class="op">|</span><span class="op">|</span> <span class="op">!</span><span class="ident">RE</span>.<span class="ident">is_match</span>(<span class="ident">name</span>) {
            <span class="kw">return</span> <span class="prelude-val">Err</span>(<span class="ident">Error</span>::<span class="ident">InvalidDefinition</span>);
        }
        <span class="kw">let</span> (<span class="ident">key</span>, <span class="ident">glob</span>) <span class="op">=</span> (<span class="ident">name</span>.<span class="ident">to_string</span>(), <span class="ident">glob</span>.<span class="ident">to_string</span>());
        <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">entry</span>(<span class="ident">key</span>).<span class="ident">or_insert_with</span>(<span class="op">|</span><span class="op">|</span> {
            <span class="ident">FileTypeDef</span> { <span class="ident">name</span>: <span class="ident">name</span>.<span class="ident">to_string</span>(), <span class="ident">globs</span>: <span class="macro">vec</span><span class="macro">!</span>[] }
        }).<span class="ident">globs</span>.<span class="ident">push</span>(<span class="ident">glob</span>);
        <span class="prelude-val">Ok</span>(())
    }

    <span class="doccomment">/// Add a new file type definition specified in string form. There are two</span>
    <span class="doccomment">/// valid formats:</span>
    <span class="doccomment">/// 1. `{name}:{glob}`.  This defines a &#39;root&#39; definition that associates the</span>
    <span class="doccomment">///     given name with the given glob.</span>
    <span class="doccomment">/// 2. `{name}:include:{comma-separated list of already defined names}.</span>
    <span class="doccomment">///     This defines an &#39;include&#39; definition that associates the given name</span>
    <span class="doccomment">///     with the definitions of the given existing types.</span>
    <span class="doccomment">/// Names may not include any characters that are not</span>
    <span class="doccomment">/// Unicode letters or numbers.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">add_def</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">self</span>, <span class="ident">def</span>: <span class="kw-2">&amp;</span><span class="ident">str</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Result</span><span class="op">&lt;</span>(), <span class="ident">Error</span><span class="op">&gt;</span> {
        <span class="kw">let</span> <span class="ident">parts</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="kw-2">&amp;</span><span class="ident">str</span><span class="op">&gt;</span> <span class="op">=</span> <span class="ident">def</span>.<span class="ident">split</span>(<span class="string">&#39;:&#39;</span>).<span class="ident">collect</span>();
        <span class="kw">match</span> <span class="ident">parts</span>.<span class="ident">len</span>() {
            <span class="number">2</span> <span class="op">=</span><span class="op">&gt;</span> {
                <span class="kw">let</span> <span class="ident">name</span> <span class="op">=</span> <span class="ident">parts</span>[<span class="number">0</span>];
                <span class="kw">let</span> <span class="ident">glob</span> <span class="op">=</span> <span class="ident">parts</span>[<span class="number">1</span>];
                <span class="kw">if</span> <span class="ident">name</span>.<span class="ident">is_empty</span>() <span class="op">|</span><span class="op">|</span> <span class="ident">glob</span>.<span class="ident">is_empty</span>() {
                    <span class="kw">return</span> <span class="prelude-val">Err</span>(<span class="ident">Error</span>::<span class="ident">InvalidDefinition</span>);
                }
                <span class="self">self</span>.<span class="ident">add</span>(<span class="ident">name</span>, <span class="ident">glob</span>)
            }
            <span class="number">3</span> <span class="op">=</span><span class="op">&gt;</span> {
                <span class="kw">let</span> <span class="ident">name</span> <span class="op">=</span> <span class="ident">parts</span>[<span class="number">0</span>];
                <span class="kw">let</span> <span class="ident">types_string</span> <span class="op">=</span> <span class="ident">parts</span>[<span class="number">2</span>];
                <span class="kw">if</span> <span class="ident">name</span>.<span class="ident">is_empty</span>() <span class="op">|</span><span class="op">|</span> <span class="ident">parts</span>[<span class="number">1</span>] <span class="op">!</span><span class="op">=</span> <span class="string">&quot;include&quot;</span> <span class="op">|</span><span class="op">|</span> <span class="ident">types_string</span>.<span class="ident">is_empty</span>() {
                    <span class="kw">return</span> <span class="prelude-val">Err</span>(<span class="ident">Error</span>::<span class="ident">InvalidDefinition</span>);
                }
                <span class="kw">let</span> <span class="ident">types</span> <span class="op">=</span> <span class="ident">types_string</span>.<span class="ident">split</span>(<span class="string">&#39;,&#39;</span>);
                <span class="comment">// Check ahead of time to ensure that all types specified are</span>
                <span class="comment">// present and fail fast if not.</span>
                <span class="kw">if</span> <span class="ident">types</span>.<span class="ident">clone</span>().<span class="ident">any</span>(<span class="op">|</span><span class="ident">t</span><span class="op">|</span> <span class="op">!</span><span class="self">self</span>.<span class="ident">types</span>.<span class="ident">contains_key</span>(<span class="ident">t</span>)) {
                    <span class="kw">return</span> <span class="prelude-val">Err</span>(<span class="ident">Error</span>::<span class="ident">InvalidDefinition</span>);
                }
                <span class="kw">for</span> <span class="ident">type_name</span> <span class="kw">in</span> <span class="ident">types</span> {
                    <span class="kw">let</span> <span class="ident">globs</span> <span class="op">=</span> <span class="self">self</span>.<span class="ident">types</span>.<span class="ident">get</span>(<span class="ident">type_name</span>).<span class="ident">unwrap</span>().<span class="ident">globs</span>.<span class="ident">clone</span>();
                    <span class="kw">for</span> <span class="ident">glob</span> <span class="kw">in</span> <span class="ident">globs</span> {
                        <span class="self">self</span>.<span class="ident">add</span>(<span class="ident">name</span>, <span class="kw-2">&amp;</span><span class="ident">glob</span>)<span class="question-mark">?</span>;
                    }
                }
                <span class="prelude-val">Ok</span>(())
            }
            <span class="kw">_</span> <span class="op">=</span><span class="op">&gt;</span> <span class="prelude-val">Err</span>(<span class="ident">Error</span>::<span class="ident">InvalidDefinition</span>)
        }
    }

    <span class="doccomment">/// Add a set of default file type definitions.</span>
    <span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">add_defaults</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">TypesBuilder</span> {
        <span class="kw">static</span> <span class="ident">MSG</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;adding a default type should never fail&quot;</span>;
        <span class="kw">for</span> <span class="kw-2">&amp;</span>(<span class="ident">name</span>, <span class="ident">exts</span>) <span class="kw">in</span> <span class="ident">DEFAULT_TYPES</span> {
            <span class="kw">for</span> <span class="ident">ext</span> <span class="kw">in</span> <span class="ident">exts</span> {
                <span class="self">self</span>.<span class="ident">add</span>(<span class="ident">name</span>, <span class="ident">ext</span>).<span class="ident">expect</span>(<span class="ident">MSG</span>);
            }
        }
        <span class="self">self</span>
    }
}

<span class="attribute">#[<span class="ident">cfg</span>(<span class="ident">test</span>)]</span>
<span class="kw">mod</span> <span class="ident">tests</span> {
    <span class="kw">use</span> <span class="kw">super</span>::<span class="ident">TypesBuilder</span>;

    <span class="macro">macro_rules</span><span class="macro">!</span> <span class="ident">matched</span> {
        (<span class="macro-nonterminal">$</span><span class="macro-nonterminal">name</span>:<span class="ident">ident</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">types</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">sel</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">selnot</span>:<span class="ident">expr</span>,
         <span class="macro-nonterminal">$</span><span class="macro-nonterminal">path</span>:<span class="ident">expr</span>) <span class="op">=</span><span class="op">&gt;</span> {
            <span class="macro">matched</span><span class="macro">!</span>(<span class="macro-nonterminal">$</span><span class="macro-nonterminal">name</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">types</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">sel</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">selnot</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">path</span>, <span class="bool-val">true</span>);
        };
        (<span class="ident">not</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">name</span>:<span class="ident">ident</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">types</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">sel</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">selnot</span>:<span class="ident">expr</span>,
         <span class="macro-nonterminal">$</span><span class="macro-nonterminal">path</span>:<span class="ident">expr</span>) <span class="op">=</span><span class="op">&gt;</span> {
            <span class="macro">matched</span><span class="macro">!</span>(<span class="macro-nonterminal">$</span><span class="macro-nonterminal">name</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">types</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">sel</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">selnot</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">path</span>, <span class="bool-val">false</span>);
        };
        (<span class="macro-nonterminal">$</span><span class="macro-nonterminal">name</span>:<span class="ident">ident</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">types</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">sel</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">selnot</span>:<span class="ident">expr</span>,
         <span class="macro-nonterminal">$</span><span class="macro-nonterminal">path</span>:<span class="ident">expr</span>, <span class="macro-nonterminal">$</span><span class="macro-nonterminal">matched</span>:<span class="ident">expr</span>) <span class="op">=</span><span class="op">&gt;</span> {
            <span class="attribute">#[<span class="ident">test</span>]</span>
            <span class="kw">fn</span> <span class="macro-nonterminal">$</span><span class="macro-nonterminal">name</span>() {
                <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">btypes</span> <span class="op">=</span> <span class="ident">TypesBuilder</span>::<span class="ident">new</span>();
                <span class="kw">for</span> <span class="ident">tydef</span> <span class="kw">in</span> <span class="macro-nonterminal">$</span><span class="macro-nonterminal">types</span> {
                    <span class="ident">btypes</span>.<span class="ident">add_def</span>(<span class="ident">tydef</span>).<span class="ident">unwrap</span>();
                }
                <span class="kw">for</span> <span class="ident">sel</span> <span class="kw">in</span> <span class="macro-nonterminal">$</span><span class="macro-nonterminal">sel</span> {
                    <span class="ident">btypes</span>.<span class="ident">select</span>(<span class="ident">sel</span>);
                }
                <span class="kw">for</span> <span class="ident">selnot</span> <span class="kw">in</span> <span class="macro-nonterminal">$</span><span class="macro-nonterminal">selnot</span> {
                    <span class="ident">btypes</span>.<span class="ident">negate</span>(<span class="ident">selnot</span>);
                }
                <span class="kw">let</span> <span class="ident">types</span> <span class="op">=</span> <span class="ident">btypes</span>.<span class="ident">build</span>().<span class="ident">unwrap</span>();
                <span class="kw">let</span> <span class="ident">mat</span> <span class="op">=</span> <span class="ident">types</span>.<span class="ident">matched</span>(<span class="macro-nonterminal">$</span><span class="macro-nonterminal">path</span>, <span class="bool-val">false</span>);
                <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="macro-nonterminal">$</span><span class="macro-nonterminal">matched</span>, <span class="op">!</span><span class="ident">mat</span>.<span class="ident">is_ignore</span>());
            }
        };
    }

    <span class="kw">fn</span> <span class="ident">types</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Vec</span><span class="op">&lt;</span><span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span><span class="op">&gt;</span> {
        <span class="macro">vec</span><span class="macro">!</span>[
            <span class="string">&quot;html:*.html&quot;</span>,
            <span class="string">&quot;html:*.htm&quot;</span>,
            <span class="string">&quot;rust:*.rs&quot;</span>,
            <span class="string">&quot;js:*.js&quot;</span>,
            <span class="string">&quot;foo:*.{rs,foo}&quot;</span>,
            <span class="string">&quot;combo:include:html,rust&quot;</span>
        ]
    }

    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match1</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;lib.rs&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match2</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;html&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;index.html&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match3</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;html&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;index.htm&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match4</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;html&quot;</span>, <span class="string">&quot;rust&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;main.rs&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match5</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;index.html&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match6</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[], <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="string">&quot;index.html&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match7</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;foo&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="string">&quot;main.foo&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match8</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;combo&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;index.html&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">match9</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;combo&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;lib.rs&quot;</span>);

    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">not</span>, <span class="ident">matchnot1</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;index.html&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">not</span>, <span class="ident">matchnot2</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[], <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="string">&quot;main.rs&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">not</span>, <span class="ident">matchnot3</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;foo&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="string">&quot;main.rs&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">not</span>, <span class="ident">matchnot4</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;foo&quot;</span>], <span class="string">&quot;main.rs&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">not</span>, <span class="ident">matchnot5</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;rust&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;foo&quot;</span>], <span class="string">&quot;main.foo&quot;</span>);
    <span class="macro">matched</span><span class="macro">!</span>(<span class="ident">not</span>, <span class="ident">matchnot6</span>, <span class="ident">types</span>(), <span class="macro">vec</span><span class="macro">!</span>[<span class="string">&quot;combo&quot;</span>], <span class="macro">vec</span><span class="macro">!</span>[], <span class="string">&quot;leftpad.js&quot;</span>);

    <span class="attribute">#[<span class="ident">test</span>]</span>
    <span class="kw">fn</span> <span class="ident">test_invalid_defs</span>() {
        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">btypes</span> <span class="op">=</span> <span class="ident">TypesBuilder</span>::<span class="ident">new</span>();
        <span class="kw">for</span> <span class="ident">tydef</span> <span class="kw">in</span> <span class="ident">types</span>() {
            <span class="ident">btypes</span>.<span class="ident">add_def</span>(<span class="ident">tydef</span>).<span class="ident">unwrap</span>();
        }
        <span class="comment">// Preserve the original definitions for later comparison.</span>
        <span class="kw">let</span> <span class="ident">original_defs</span> <span class="op">=</span> <span class="ident">btypes</span>.<span class="ident">definitions</span>();
        <span class="kw">let</span> <span class="ident">bad_defs</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[
            <span class="comment">// Reference to type that does not exist</span>
            <span class="string">&quot;combo:include:html,python&quot;</span>,
            <span class="comment">// Bad format</span>
            <span class="string">&quot;combo:foobar:html,rust&quot;</span>,
            <span class="string">&quot;&quot;</span>
        ];
        <span class="kw">for</span> <span class="ident">def</span> <span class="kw">in</span> <span class="ident">bad_defs</span> {
            <span class="macro">assert</span><span class="macro">!</span>(<span class="ident">btypes</span>.<span class="ident">add_def</span>(<span class="ident">def</span>).<span class="ident">is_err</span>());
            <span class="comment">// Ensure that nothing changed, even if some of the includes were valid.</span>
            <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">btypes</span>.<span class="ident">definitions</span>(), <span class="ident">original_defs</span>);
        }
    }
}
</pre></div>
</section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "ignore";</script><script src="../../main.js"></script><script src="../../source-script.js"></script><script src="../../source-files.js"></script><script defer src="../../search-index.js"></script></body></html>